https://docs.openstack.org/install-guide/environment-sql-database-ubuntu.html

SQL Database

wei@wei-ThinkPad-X1-Extreme:~$ sudo apt-get install -y mariadb-server python-pymysql
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following packages were automatically installed and are no longer required:
  fonts-liberation2 fonts-opensymbol gir1.2-geocodeglib-1.0
  gir1.2-gst-plugins-base-1.0 gir1.2-gstreamer-1.0 gir1.2-gudev-1.0
  gir1.2-udisks-2.0 grilo-plugins-0.3-base gstreamer1.0-gtk3
  libboost-date-time1.65.1 libboost-filesystem1.65.1 libboost-iostreams1.65.1
  libboost-locale1.65.1 libcdr-0.1-1 libclucene-contribs1v5 libclucene-core1v5
  libcmis-0.5-5v5 libcolamd2 libdazzle-1.0-0 libe-book-0.1-1
  libedataserverui-1.2-2 libeot0 libepubgen-0.1-1 libetonyek-0.1-1
  libevent-2.1-6 libexiv2-14 libfreerdp-client2-2 libfreerdp2-2 libgc1c2
  libgee-0.8-2 libgexiv2-2 libgom-1.0-0 libgpgmepp6 libgpod-common libgpod4
  liblangtag-common liblangtag1 liblirc-client0 libllvm8 liblua5.3-0
  libmediaart-2.0-0 libmspub-0.1-1 libodfgen-0.1-1 libqqwing2v5 libraw16
  librevenge-0.0-0 libsgutils2-2 libssh-4 libsuitesparseconfig5 libvncclient1
  libwinpr2-2 libxapian30 libxmlsec1 libxmlsec1-nss lp-solve media-player-info
  syslinux syslinux-common syslinux-legacy usb-creator-common
Use 'sudo apt autoremove' to remove them.
The following additional packages will be installed:
  galera-3 gawk libaio1 libconfig-inifiles-perl libdbd-mysql-perl libdbi-perl
  libhtml-template-perl libjemalloc1 libmysqlclient20 libpython-stdlib
  libreadline5 libsigsegv2 libterm-readkey-perl mariadb-client-10.1
  mariadb-client-core-10.1 mariadb-common mariadb-server-10.1
  mariadb-server-core-10.1 mysql-common python python-minimal python2.7
  python2.7-minimal socat
Suggested packages:
  gawk-doc libmldbm-perl libnet-daemon-perl libsql-statement-perl
  libipc-sharedcache-perl mailx mariadb-test tinyca python-doc python-tk
  python-pymysql-doc python2.7-doc binfmt-support
The following NEW packages will be installed:
  galera-3 gawk libaio1 libconfig-inifiles-perl libdbd-mysql-perl libdbi-perl
  libhtml-template-perl libjemalloc1 libmysqlclient20 libpython-stdlib
  libreadline5 libsigsegv2 libterm-readkey-perl mariadb-client-10.1
  mariadb-client-core-10.1 mariadb-common mariadb-server mariadb-server-10.1
  mariadb-server-core-10.1 mysql-common python python-minimal python-pymysql
  python2.7 python2.7-minimal socat
0 upgraded, 26 newly installed, 0 to remove and 0 not upgraded.
Need to get 24.3 MB/25.9 MB of archives.
After this operation, 190 MB of additional disk space will be used.
Get:1 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 libsigsegv2 amd64 2.12-1 [14.7 kB]
Get:2 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 gawk amd64 1:4.1.4+dfsg-1build1 [401 kB]
Get:3 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 mysql-common all 5.8+1.0.4 [7,308 B]
Get:4 http://cn.archive.ubuntu.com/ubuntu bionic-updates/universe amd64 mariadb-common all 1:10.1.43-0ubuntu0.18.04.1 [29.6 kB]
Get:5 http://cn.archive.ubuntu.com/ubuntu bionic/universe amd64 galera-3 amd64 25.3.20-1 [947 kB]
Get:6 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 libdbi-perl amd64 1.640-1 [724 kB]
Get:7 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 libconfig-inifiles-perl all 2.94-1 [40.4 kB]
Get:8 http://cn.archive.ubuntu.com/ubuntu bionic-updates/main amd64 libaio1 amd64 0.3.110-5ubuntu0.1 [6,476 B]
Get:9 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 libreadline5 amd64 5.2+dfsg-3build1 [99.5 kB]
Get:10 http://cn.archive.ubuntu.com/ubuntu bionic-updates/universe amd64 mariadb-client-core-10.1 amd64 1:10.1.43-0ubuntu0.18.04.1 [4,778 kB]
Get:11 http://cn.archive.ubuntu.com/ubuntu bionic/universe amd64 libjemalloc1 amd64 3.6.0-11 [82.4 kB]
Get:12 http://cn.archive.ubuntu.com/ubuntu bionic-updates/universe amd64 mariadb-client-10.1 amd64 1:10.1.43-0ubuntu0.18.04.1 [5,658 kB]
Get:13 http://cn.archive.ubuntu.com/ubuntu bionic-updates/universe amd64 mariadb-server-core-10.1 amd64 1:10.1.43-0ubuntu0.18.04.1 [4,960 kB]
Get:14 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 socat amd64 1.7.3.2-2ubuntu2 [342 kB]
Get:15 http://cn.archive.ubuntu.com/ubuntu bionic-updates/universe amd64 mariadb-server-10.1 amd64 1:10.1.43-0ubuntu0.18.04.1 [5,108 kB]
Get:16 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 python-minimal amd64 2.7.15~rc1-1 [28.1 kB]
Get:17 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 libpython-stdlib amd64 2.7.15~rc1-1 [7,620 B]
Get:18 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 python amd64 2.7.15~rc1-1 [140 kB]
Get:19 http://cn.archive.ubuntu.com/ubuntu bionic-updates/main amd64 libmysqlclient20 amd64 5.7.29-0ubuntu0.18.04.1 [690 kB]
Get:20 http://cn.archive.ubuntu.com/ubuntu bionic/universe amd64 libdbd-mysql-perl amd64 4.046-1 [82.0 kB]
Get:21 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 libhtml-template-perl all 2.97-1 [59.0 kB]
Get:22 http://cn.archive.ubuntu.com/ubuntu bionic/universe amd64 libterm-readkey-perl amd64 2.37-1build1 [24.4 kB]
Get:23 http://cn.archive.ubuntu.com/ubuntu bionic-updates/universe amd64 mariadb-server all 1:10.1.43-0ubuntu0.18.04.1 [28.5 kB]
Get:24 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 python-pymysql all 0.8.0-1 [60.0 kB]
Fetched 24.3 MB in 9s (2,742 kB/s)                                             
Preconfiguring packages ...
Selecting previously unselected package libsigsegv2:amd64.
(Reading database ... 201395 files and directories currently installed.)
Preparing to unpack .../libsigsegv2_2.12-1_amd64.deb ...
Unpacking libsigsegv2:amd64 (2.12-1) ...
Setting up libsigsegv2:amd64 (2.12-1) ...
Selecting previously unselected package gawk.
(Reading database ... 201402 files and directories currently installed.)
Preparing to unpack .../00-gawk_1%3a4.1.4+dfsg-1build1_amd64.deb ...
Unpacking gawk (1:4.1.4+dfsg-1build1) ...
Selecting previously unselected package mysql-common.
Preparing to unpack .../01-mysql-common_5.8+1.0.4_all.deb ...
Unpacking mysql-common (5.8+1.0.4) ...
Selecting previously unselected package mariadb-common.
Preparing to unpack .../02-mariadb-common_1%3a10.1.43-0ubuntu0.18.04.1_all.deb ...
Unpacking mariadb-common (1:10.1.43-0ubuntu0.18.04.1) ...
Selecting previously unselected package galera-3.
Preparing to unpack .../03-galera-3_25.3.20-1_amd64.deb ...
Unpacking galera-3 (25.3.20-1) ...
Selecting previously unselected package libdbi-perl.
Preparing to unpack .../04-libdbi-perl_1.640-1_amd64.deb ...
Unpacking libdbi-perl (1.640-1) ...
Selecting previously unselected package libconfig-inifiles-perl.
Preparing to unpack .../05-libconfig-inifiles-perl_2.94-1_all.deb ...
Unpacking libconfig-inifiles-perl (2.94-1) ...
Selecting previously unselected package libaio1:amd64.
Preparing to unpack .../06-libaio1_0.3.110-5ubuntu0.1_amd64.deb ...
Unpacking libaio1:amd64 (0.3.110-5ubuntu0.1) ...
Selecting previously unselected package libreadline5:amd64.
Preparing to unpack .../07-libreadline5_5.2+dfsg-3build1_amd64.deb ...
Unpacking libreadline5:amd64 (5.2+dfsg-3build1) ...
Selecting previously unselected package mariadb-client-core-10.1.
Preparing to unpack .../08-mariadb-client-core-10.1_1%3a10.1.43-0ubuntu0.18.04.1_amd64.deb ...
Unpacking mariadb-client-core-10.1 (1:10.1.43-0ubuntu0.18.04.1) ...
Selecting previously unselected package libjemalloc1.
Preparing to unpack .../09-libjemalloc1_3.6.0-11_amd64.deb ...
Unpacking libjemalloc1 (3.6.0-11) ...
Selecting previously unselected package mariadb-client-10.1.
Preparing to unpack .../10-mariadb-client-10.1_1%3a10.1.43-0ubuntu0.18.04.1_amd64.deb ...
Unpacking mariadb-client-10.1 (1:10.1.43-0ubuntu0.18.04.1) ...
Selecting previously unselected package mariadb-server-core-10.1.
Preparing to unpack .../11-mariadb-server-core-10.1_1%3a10.1.43-0ubuntu0.18.04.1_amd64.deb ...
Unpacking mariadb-server-core-10.1 (1:10.1.43-0ubuntu0.18.04.1) ...
Selecting previously unselected package socat.
Preparing to unpack .../12-socat_1.7.3.2-2ubuntu2_amd64.deb ...
Unpacking socat (1.7.3.2-2ubuntu2) ...
Setting up mysql-common (5.8+1.0.4) ...
update-alternatives: using /etc/mysql/my.cnf.fallback to provide /etc/mysql/my.cnf (my.cnf) in auto mode
Setting up mariadb-common (1:10.1.43-0ubuntu0.18.04.1) ...
update-alternatives: using /etc/mysql/mariadb.cnf to provide /etc/mysql/my.cnf (my.cnf) in auto mode
Selecting previously unselected package mariadb-server-10.1.
(Reading database ... 201941 files and directories currently installed.)
Preparing to unpack .../mariadb-server-10.1_1%3a10.1.43-0ubuntu0.18.04.1_amd64.deb ...
Unpacking mariadb-server-10.1 (1:10.1.43-0ubuntu0.18.04.1) ...
Selecting previously unselected package python2.7-minimal.
Preparing to unpack .../python2.7-minimal_2.7.17-1~18.04_amd64.deb ...
Unpacking python2.7-minimal (2.7.17-1~18.04) ...
Selecting previously unselected package python-minimal.
Preparing to unpack .../python-minimal_2.7.15~rc1-1_amd64.deb ...
Unpacking python-minimal (2.7.15~rc1-1) ...
Selecting previously unselected package python2.7.
Preparing to unpack .../python2.7_2.7.17-1~18.04_amd64.deb ...
Unpacking python2.7 (2.7.17-1~18.04) ...
Selecting previously unselected package libpython-stdlib:amd64.
Preparing to unpack .../libpython-stdlib_2.7.15~rc1-1_amd64.deb ...
Unpacking libpython-stdlib:amd64 (2.7.15~rc1-1) ...
Setting up python2.7-minimal (2.7.17-1~18.04) ...
Linking and byte-compiling packages for runtime python2.7...
Setting up python-minimal (2.7.15~rc1-1) ...
Selecting previously unselected package python.
(Reading database ... 202136 files and directories currently installed.)
Preparing to unpack .../0-python_2.7.15~rc1-1_amd64.deb ...
Unpacking python (2.7.15~rc1-1) ...
Selecting previously unselected package libmysqlclient20:amd64.
Preparing to unpack .../1-libmysqlclient20_5.7.29-0ubuntu0.18.04.1_amd64.deb ...
Unpacking libmysqlclient20:amd64 (5.7.29-0ubuntu0.18.04.1) ...
Selecting previously unselected package libdbd-mysql-perl.
Preparing to unpack .../2-libdbd-mysql-perl_4.046-1_amd64.deb ...
Unpacking libdbd-mysql-perl (4.046-1) ...
Selecting previously unselected package libhtml-template-perl.
Preparing to unpack .../3-libhtml-template-perl_2.97-1_all.deb ...
Unpacking libhtml-template-perl (2.97-1) ...
Selecting previously unselected package libterm-readkey-perl.
Preparing to unpack .../4-libterm-readkey-perl_2.37-1build1_amd64.deb ...
Unpacking libterm-readkey-perl (2.37-1build1) ...
Selecting previously unselected package mariadb-server.
Preparing to unpack .../5-mariadb-server_1%3a10.1.43-0ubuntu0.18.04.1_all.deb ...
Unpacking mariadb-server (1:10.1.43-0ubuntu0.18.04.1) ...
Selecting previously unselected package python-pymysql.
Preparing to unpack .../6-python-pymysql_0.8.0-1_all.deb ...
Unpacking python-pymysql (0.8.0-1) ...
Setting up libconfig-inifiles-perl (2.94-1) ...
Setting up libhtml-template-perl (2.97-1) ...
Setting up libjemalloc1 (3.6.0-11) ...
Setting up socat (1.7.3.2-2ubuntu2) ...
Setting up python2.7 (2.7.17-1~18.04) ...
Setting up gawk (1:4.1.4+dfsg-1build1) ...
Setting up libterm-readkey-perl (2.37-1build1) ...
Setting up libpython-stdlib:amd64 (2.7.15~rc1-1) ...
Setting up libaio1:amd64 (0.3.110-5ubuntu0.1) ...
Setting up galera-3 (25.3.20-1) ...
Setting up libmysqlclient20:amd64 (5.7.29-0ubuntu0.18.04.1) ...
Setting up libreadline5:amd64 (5.2+dfsg-3build1) ...
Setting up libdbi-perl (1.640-1) ...
Setting up python (2.7.15~rc1-1) ...
Setting up mariadb-server-core-10.1 (1:10.1.43-0ubuntu0.18.04.1) ...
Setting up mariadb-client-core-10.1 (1:10.1.43-0ubuntu0.18.04.1) ...
Setting up python-pymysql (0.8.0-1) ...
Setting up libdbd-mysql-perl (4.046-1) ...
Setting up mariadb-client-10.1 (1:10.1.43-0ubuntu0.18.04.1) ...
Setting up mariadb-server-10.1 (1:10.1.43-0ubuntu0.18.04.1) ...
Created symlink /etc/systemd/system/mysql.service → /lib/systemd/system/mariadb.service.
Created symlink /etc/systemd/system/mysqld.service → /lib/systemd/system/mariadb.service.
Created symlink /etc/systemd/system/multi-user.target.wants/mariadb.service → /lib/systemd/system/mariadb.service.
Setting up mariadb-server (1:10.1.43-0ubuntu0.18.04.1) ...
Processing triggers for ureadahead (0.100.0-21) ...
Processing triggers for desktop-file-utils (0.23-1ubuntu3.18.04.2) ...
Processing triggers for libc-bin (2.27-3ubuntu1) ...
Processing triggers for systemd (237-3ubuntu10.33) ...
Processing triggers for man-db (2.8.3-2ubuntu0.1) ...
Processing triggers for gnome-menus (3.13.3-11ubuntu1.1) ...
Processing triggers for mime-support (3.60ubuntu1) ...


wei@wei-ThinkPad-X1-Extreme:~$ cat > 99-openstack.cnf << EOF
> [mysqld]
> bind-address = 0.0.0.0
> 
> default-storage-engine = innodb
> innodb_file_per_table = on
> max_connections = 4096
> collation-server = utf8_general_ci
> character-set-server = utf8
> EOF
wei@wei-ThinkPad-X1-Extreme:~$ sudo chown root: 99-openstack.cnf 
wei@wei-ThinkPad-X1-Extreme:~$ sudo mv 99-openstack.cnf /etc/mysql/mariadb.conf.d/


wei@wei-ThinkPad-X1-Extreme:~$ sudo systemctl start mysqld.service
wei@wei-ThinkPad-X1-Extreme:~$ sudo systemctl status -l --no-pager mysqld.service
● mariadb.service - MariaDB 10.1.43 database server
   Loaded: loaded (/lib/systemd/system/mariadb.service; enabled; vendor preset: enabled)
   Active: active (running) since Fri 2020-01-31 20:03:00 CST; 13min ago
     Docs: man:mysqld(8)
           https://mariadb.com/kb/en/library/systemd/
 Main PID: 10630 (mysqld)
   Status: "Taking your SQL requests now..."
    Tasks: 27 (limit: 4915)
   CGroup: /system.slice/mariadb.service
           └─10630 /usr/sbin/mysqld

1月 31 20:03:00 wei-ThinkPad-X1-Extreme /etc/mysql/debian-start[10663]: Processing databases
1月 31 20:03:00 wei-ThinkPad-X1-Extreme /etc/mysql/debian-start[10663]: information_schema
1月 31 20:03:00 wei-ThinkPad-X1-Extreme /etc/mysql/debian-start[10663]: mysql
1月 31 20:03:00 wei-ThinkPad-X1-Extreme /etc/mysql/debian-start[10663]: performance_schema
1月 31 20:03:00 wei-ThinkPad-X1-Extreme /etc/mysql/debian-start[10663]: Phase 6/7: Checking and upgrading tables
1月 31 20:03:00 wei-ThinkPad-X1-Extreme /etc/mysql/debian-start[10663]: Processing databases
1月 31 20:03:00 wei-ThinkPad-X1-Extreme /etc/mysql/debian-start[10663]: information_schema
1月 31 20:03:00 wei-ThinkPad-X1-Extreme /etc/mysql/debian-start[10663]: performance_schema
1月 31 20:03:00 wei-ThinkPad-X1-Extreme /etc/mysql/debian-start[10663]: Phase 7/7: Running 'FLUSH PRIVILEGES'
1月 31 20:03:00 wei-ThinkPad-X1-Extreme /etc/mysql/debian-start[10663]: OK



wei@wei-ThinkPad-X1-Extreme:~$ mysql --version
mysql  Ver 15.1 Distrib 10.1.43-MariaDB, for debian-linux-gnu (x86_64) using readline 5.2

wei@wei-ThinkPad-X1-Extreme:~$ sudo systemctl stop mysqld


wei@wei-ThinkPad-X1-Extreme:~$ sudo mysqld_safe --skip-grant-tables --skip-networking &
[1] 12483

wei@wei-ThinkPad-X1-Extreme:~$ sudo mysql -u root --execute="FLUSH PRIVILEGES;SET PASSWORD FOR 'root'@'localhost' = PASSWORD('MARIADB_PASS');"

wei@wei-ThinkPad-X1-Extreme:~$ sudo kill `sudo cat /var/run/mysqld/mysqld.pid`


wei@wei-ThinkPad-X1-Extreme:~$ sudo apt-get install net-tools
[sudo] password for wei: 
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following packages were automatically installed and are no longer required:
  fonts-liberation2 fonts-opensymbol gir1.2-geocodeglib-1.0
  gir1.2-gst-plugins-base-1.0 gir1.2-gstreamer-1.0 gir1.2-gudev-1.0
  gir1.2-udisks-2.0 grilo-plugins-0.3-base gstreamer1.0-gtk3
  libboost-date-time1.65.1 libboost-filesystem1.65.1 libboost-iostreams1.65.1
  libboost-locale1.65.1 libcdr-0.1-1 libclucene-contribs1v5 libclucene-core1v5
  libcmis-0.5-5v5 libcolamd2 libdazzle-1.0-0 libe-book-0.1-1
  libedataserverui-1.2-2 libeot0 libepubgen-0.1-1 libetonyek-0.1-1
  libevent-2.1-6 libexiv2-14 libfreerdp-client2-2 libfreerdp2-2 libgc1c2
  libgee-0.8-2 libgexiv2-2 libgom-1.0-0 libgpgmepp6 libgpod-common libgpod4
  liblangtag-common liblangtag1 liblirc-client0 libllvm8 liblua5.3-0
  libmediaart-2.0-0 libmspub-0.1-1 libodfgen-0.1-1 libqqwing2v5 libraw16
  librevenge-0.0-0 libsgutils2-2 libssh-4 libsuitesparseconfig5 libvncclient1
  libwinpr2-2 libxapian30 libxmlsec1 libxmlsec1-nss lp-solve media-player-info
  syslinux syslinux-common syslinux-legacy usb-creator-common
Use 'sudo apt autoremove' to remove them.
The following NEW packages will be installed:
  net-tools
0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
Need to get 194 kB of archives.
After this operation, 803 kB of additional disk space will be used.
Get:1 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 net-tools amd64 1.60+git20161116.90da8a0-1ubuntu1 [194 kB]
Fetched 194 kB in 3s (75.8 kB/s)                       
Selecting previously unselected package net-tools.
(Reading database ... 202281 files and directories currently installed.)
Preparing to unpack .../net-tools_1.60+git20161116.90da8a0-1ubuntu1_amd64.deb ...
Unpacking net-tools (1.60+git20161116.90da8a0-1ubuntu1) ...
Setting up net-tools (1.60+git20161116.90da8a0-1ubuntu1) ...
Processing triggers for man-db (2.8.3-2ubuntu0.1) ...
wei@wei-ThinkPad-X1-Extreme:~$ sudo netstat -tpnl
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 0.0.0.0:3306            0.0.0.0:*               LISTEN      13484/mysqld        
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      8537/systemd-resolv 
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      4164/sshd           
tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN      28252/cupsd         
tcp6       0      0 :::22                   :::*                    LISTEN      4164/sshd           
tcp6       0      0 ::1:631                 :::*                    LISTEN      28252/cupsd         


https://docs.openstack.org/install-guide/environment-messaging-ubuntu.html

Message Queue

wei@wei-ThinkPad-X1-Extreme:~$ sudo apt-get install -y rabbitmq-server
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following packages were automatically installed and are no longer required:
  fonts-liberation2 fonts-opensymbol gir1.2-geocodeglib-1.0
  gir1.2-gst-plugins-base-1.0 gir1.2-gstreamer-1.0 gir1.2-gudev-1.0
  gir1.2-udisks-2.0 grilo-plugins-0.3-base gstreamer1.0-gtk3
  libboost-date-time1.65.1 libboost-filesystem1.65.1 libboost-iostreams1.65.1
  libboost-locale1.65.1 libcdr-0.1-1 libclucene-contribs1v5 libclucene-core1v5
  libcmis-0.5-5v5 libcolamd2 libdazzle-1.0-0 libe-book-0.1-1
  libedataserverui-1.2-2 libeot0 libepubgen-0.1-1 libetonyek-0.1-1
  libevent-2.1-6 libexiv2-14 libfreerdp-client2-2 libfreerdp2-2 libgc1c2
  libgee-0.8-2 libgexiv2-2 libgom-1.0-0 libgpgmepp6 libgpod-common libgpod4
  liblangtag-common liblangtag1 liblirc-client0 libllvm8 liblua5.3-0
  libmediaart-2.0-0 libmspub-0.1-1 libodfgen-0.1-1 libqqwing2v5 libraw16
  librevenge-0.0-0 libsgutils2-2 libssh-4 libsuitesparseconfig5 libvncclient1
  libwinpr2-2 libxapian30 libxmlsec1 libxmlsec1-nss lp-solve media-player-info
  syslinux syslinux-common syslinux-legacy usb-creator-common
Use 'sudo apt autoremove' to remove them.
The following additional packages will be installed:
  erlang-asn1 erlang-base erlang-corba erlang-crypto erlang-diameter
  erlang-edoc erlang-eldap erlang-erl-docgen erlang-eunit erlang-ic
  erlang-inets erlang-mnesia erlang-nox erlang-odbc erlang-os-mon
  erlang-parsetools erlang-public-key erlang-runtime-tools erlang-snmp
  erlang-ssh erlang-ssl erlang-syntax-tools erlang-tools erlang-xmerl libodbc1
  libsctp1
Suggested packages:
  erlang erlang-manpages erlang-doc xsltproc fop erlang-ic-java libmyodbc
  odbc-postgresql tdsodbc unixodbc-bin lksctp-tools
The following NEW packages will be installed:
  erlang-asn1 erlang-base erlang-corba erlang-crypto erlang-diameter
  erlang-edoc erlang-eldap erlang-erl-docgen erlang-eunit erlang-ic
  erlang-inets erlang-mnesia erlang-nox erlang-odbc erlang-os-mon
  erlang-parsetools erlang-public-key erlang-runtime-tools erlang-snmp
  erlang-ssh erlang-ssl erlang-syntax-tools erlang-tools erlang-xmerl libodbc1
  libsctp1 rabbitmq-server
0 upgraded, 27 newly installed, 0 to remove and 0 not upgraded.
Need to get 24.5 MB of archives.
After this operation, 40.5 MB of additional disk space will be used.
Get:1 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-base amd64 1:20.2.2+dfsg-1ubuntu2 [7,323 kB]
Get:2 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-asn1 amd64 1:20.2.2+dfsg-1ubuntu2 [724 kB]
Get:3 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-mnesia amd64 1:20.2.2+dfsg-1ubuntu2 [724 kB]
Get:4 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-runtime-tools amd64 1:20.2.2+dfsg-1ubuntu2 [178 kB]
Get:5 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-crypto amd64 1:20.2.2+dfsg-1ubuntu2 [104 kB]
Get:6 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-public-key amd64 1:20.2.2+dfsg-1ubuntu2 [561 kB]
Get:7 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-ssl amd64 1:20.2.2+dfsg-1ubuntu2 [814 kB]
Get:8 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-inets amd64 1:20.2.2+dfsg-1ubuntu2 [711 kB]
Get:9 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-corba amd64 1:20.2.2+dfsg-1ubuntu2 [2,251 kB]
Get:10 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-syntax-tools amd64 1:20.2.2+dfsg-1ubuntu2 [345 kB]
Get:11 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-diameter amd64 1:20.2.2+dfsg-1ubuntu2 [647 kB]
Get:12 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-xmerl amd64 1:20.2.2+dfsg-1ubuntu2 [964 kB]
Get:13 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-edoc amd64 1:20.2.2+dfsg-1ubuntu2 [283 kB]
Get:14 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-eldap amd64 1:20.2.2+dfsg-1ubuntu2 [101 kB]
Get:15 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-erl-docgen amd64 1:20.2.2+dfsg-1ubuntu2 [118 kB]
Get:16 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-eunit amd64 1:20.2.2+dfsg-1ubuntu2 [136 kB]
Get:17 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-ic amd64 1:20.2.2+dfsg-1ubuntu2 [817 kB]
Get:18 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 libodbc1 amd64 2.3.4-1.1ubuntu3 [183 kB]
Get:19 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-odbc amd64 1:20.2.2+dfsg-1ubuntu2 [47.5 kB]
Get:20 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-snmp amd64 1:20.2.2+dfsg-1ubuntu2 [1,531 kB]
Get:21 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-os-mon amd64 1:20.2.2+dfsg-1ubuntu2 [90.4 kB]
Get:22 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-parsetools amd64 1:20.2.2+dfsg-1ubuntu2 [153 kB]
Get:23 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-ssh amd64 1:20.2.2+dfsg-1ubuntu2 [508 kB]
Get:24 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-tools amd64 1:20.2.2+dfsg-1ubuntu2 [503 kB]
Get:25 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 erlang-nox all 1:20.2.2+dfsg-1ubuntu2 [13.4 kB]
Get:26 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 libsctp1 amd64 1.0.17+dfsg-2 [8,008 B]
Get:27 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 rabbitmq-server all 3.6.10-1 [4,625 kB]
Fetched 24.5 MB in 11s (2,176 kB/s)                                            
Selecting previously unselected package erlang-base.
(Reading database ... 202329 files and directories currently installed.)
Preparing to unpack .../00-erlang-base_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-base (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-asn1.
Preparing to unpack .../01-erlang-asn1_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-asn1 (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-mnesia.
Preparing to unpack .../02-erlang-mnesia_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-mnesia (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-runtime-tools.
Preparing to unpack .../03-erlang-runtime-tools_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-runtime-tools (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-crypto.
Preparing to unpack .../04-erlang-crypto_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-crypto (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-public-key.
Preparing to unpack .../05-erlang-public-key_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-public-key (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-ssl.
Preparing to unpack .../06-erlang-ssl_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-ssl (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-inets.
Preparing to unpack .../07-erlang-inets_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-inets (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-corba.
Preparing to unpack .../08-erlang-corba_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-corba (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-syntax-tools.
Preparing to unpack .../09-erlang-syntax-tools_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-syntax-tools (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-diameter.
Preparing to unpack .../10-erlang-diameter_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-diameter (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-xmerl.
Preparing to unpack .../11-erlang-xmerl_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-xmerl (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-edoc.
Preparing to unpack .../12-erlang-edoc_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-edoc (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-eldap.
Preparing to unpack .../13-erlang-eldap_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-eldap (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-erl-docgen.
Preparing to unpack .../14-erlang-erl-docgen_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-erl-docgen (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-eunit.
Preparing to unpack .../15-erlang-eunit_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-eunit (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-ic.
Preparing to unpack .../16-erlang-ic_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-ic (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package libodbc1:amd64.
Preparing to unpack .../17-libodbc1_2.3.4-1.1ubuntu3_amd64.deb ...
Unpacking libodbc1:amd64 (2.3.4-1.1ubuntu3) ...
Selecting previously unselected package erlang-odbc.
Preparing to unpack .../18-erlang-odbc_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-odbc (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-snmp.
Preparing to unpack .../19-erlang-snmp_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-snmp (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-os-mon.
Preparing to unpack .../20-erlang-os-mon_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-os-mon (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-parsetools.
Preparing to unpack .../21-erlang-parsetools_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-parsetools (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-ssh.
Preparing to unpack .../22-erlang-ssh_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-ssh (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-tools.
Preparing to unpack .../23-erlang-tools_1%3a20.2.2+dfsg-1ubuntu2_amd64.deb ...
Unpacking erlang-tools (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package erlang-nox.
Preparing to unpack .../24-erlang-nox_1%3a20.2.2+dfsg-1ubuntu2_all.deb ...
Unpacking erlang-nox (1:20.2.2+dfsg-1ubuntu2) ...
Selecting previously unselected package libsctp1:amd64.
Preparing to unpack .../25-libsctp1_1.0.17+dfsg-2_amd64.deb ...
Unpacking libsctp1:amd64 (1.0.17+dfsg-2) ...
Selecting previously unselected package rabbitmq-server.
Preparing to unpack .../26-rabbitmq-server_3.6.10-1_all.deb ...
Unpacking rabbitmq-server (3.6.10-1) ...
Setting up libodbc1:amd64 (2.3.4-1.1ubuntu3) ...
Setting up erlang-base (1:20.2.2+dfsg-1ubuntu2) ...
Searching for services which depend on erlang and should be started...none found.
Setting up libsctp1:amd64 (1.0.17+dfsg-2) ...
Setting up erlang-ic (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-xmerl (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-crypto (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-asn1 (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-mnesia (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-eunit (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-runtime-tools (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-syntax-tools (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-odbc (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-parsetools (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-public-key (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-snmp (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-ssl (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-inets (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-tools (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-diameter (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-ssh (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-os-mon (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-eldap (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-edoc (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-corba (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-erl-docgen (1:20.2.2+dfsg-1ubuntu2) ...
Setting up erlang-nox (1:20.2.2+dfsg-1ubuntu2) ...
Setting up rabbitmq-server (3.6.10-1) ...
Adding group `rabbitmq' (GID 131) ...
Done.
Adding system user `rabbitmq' (UID 127) ...
Adding new user `rabbitmq' (UID 127) with group `rabbitmq' ...
Not creating home directory `/var/lib/rabbitmq'.
Created symlink /etc/systemd/system/multi-user.target.wants/rabbitmq-server.service → /lib/systemd/system/rabbitmq-server.service.
Processing triggers for systemd (237-3ubuntu10.33) ...
Processing triggers for man-db (2.8.3-2ubuntu0.1) ...
Processing triggers for ureadahead (0.100.0-21) ...
Processing triggers for libc-bin (2.27-3ubuntu1) ...


wei@wei-ThinkPad-X1-Extreme:~$ sudo rabbitmqctl add_user openstack RABBIT_PASS
Creating user "openstack"
wei@wei-ThinkPad-X1-Extreme:~$ sudo rabbitmqctl set_permissions openstack ".*" ".*" ".*"
Setting permissions for user "openstack" in vhost "/"


https://docs.openstack.org/install-guide/environment-memcached-ubuntu.html

Memcache

wei@wei-ThinkPad-X1-Extreme:~$ sudo apt install -y memcached python-memcache
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following packages were automatically installed and are no longer required:
  fonts-liberation2 fonts-opensymbol gir1.2-geocodeglib-1.0
  gir1.2-gst-plugins-base-1.0 gir1.2-gstreamer-1.0 gir1.2-gudev-1.0
  gir1.2-udisks-2.0 grilo-plugins-0.3-base gstreamer1.0-gtk3
  libboost-date-time1.65.1 libboost-filesystem1.65.1 libboost-iostreams1.65.1
  libboost-locale1.65.1 libcdr-0.1-1 libclucene-contribs1v5 libclucene-core1v5
  libcmis-0.5-5v5 libcolamd2 libdazzle-1.0-0 libe-book-0.1-1
  libedataserverui-1.2-2 libeot0 libepubgen-0.1-1 libetonyek-0.1-1 libexiv2-14
  libfreerdp-client2-2 libfreerdp2-2 libgc1c2 libgee-0.8-2 libgexiv2-2
  libgom-1.0-0 libgpgmepp6 libgpod-common libgpod4 liblangtag-common
  liblangtag1 liblirc-client0 libllvm8 liblua5.3-0 libmediaart-2.0-0
  libmspub-0.1-1 libodfgen-0.1-1 libqqwing2v5 libraw16 librevenge-0.0-0
  libsgutils2-2 libssh-4 libsuitesparseconfig5 libvncclient1 libwinpr2-2
  libxapian30 libxmlsec1 libxmlsec1-nss lp-solve media-player-info syslinux
  syslinux-common syslinux-legacy usb-creator-common
Use 'sudo apt autoremove' to remove them.
The following additional packages will be installed:
  python-six
Suggested packages:
  libcache-memcached-perl libmemcached libanyevent-perl libyaml-perl
The following NEW packages will be installed:
  memcached python-memcache python-six
0 upgraded, 3 newly installed, 0 to remove and 0 not upgraded.
Need to get 139 kB of archives.
After this operation, 429 kB of additional disk space will be used.
Get:1 http://cn.archive.ubuntu.com/ubuntu bionic-updates/main amd64 memcached amd64 1.5.6-0ubuntu1.2 [109 kB]
Get:2 http://ubuntu-cloud.archive.canonical.com/ubuntu bionic-updates/stein/main amd64 python-memcache all 1.59-1~cloud0 [18.1 kB]
Get:3 http://cn.archive.ubuntu.com/ubuntu bionic/main amd64 python-six all 1.11.0-2 [11.3 kB]
Fetched 139 kB in 2s (61.8 kB/s)      
Selecting previously unselected package memcached.
(Reading database ... 204335 files and directories currently installed.)
Preparing to unpack .../memcached_1.5.6-0ubuntu1.2_amd64.deb ...
Unpacking memcached (1.5.6-0ubuntu1.2) ...
Selecting previously unselected package python-six.
Preparing to unpack .../python-six_1.11.0-2_all.deb ...
Unpacking python-six (1.11.0-2) ...
Selecting previously unselected package python-memcache.
Preparing to unpack .../python-memcache_1.59-1~cloud0_all.deb ...
Unpacking python-memcache (1.59-1~cloud0) ...
Setting up memcached (1.5.6-0ubuntu1.2) ...
Created symlink /etc/systemd/system/multi-user.target.wants/memcached.service → /lib/systemd/system/memcached.service.
Setting up python-six (1.11.0-2) ...
Setting up python-memcache (1.59-1~cloud0) ...
Processing triggers for man-db (2.8.3-2ubuntu0.1) ...
Processing triggers for ureadahead (0.100.0-21) ...
Processing triggers for systemd (237-3ubuntu10.33) ...

wei@wei-ThinkPad-X1-Extreme:~$ sudo sed -i "s/-l 127.0.0.1/# &\n-l 0.0.0.0/"  /etc/memcached.conf 

wei@wei-ThinkPad-X1-Extreme:~$ sudo systemctl start memcached.service
wei@wei-ThinkPad-X1-Extreme:~$ sudo netstat -tpnl
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 0.0.0.0:25672           0.0.0.0:*               LISTEN      15015/beam.smp      
tcp        0      0 0.0.0.0:3306            0.0.0.0:*               LISTEN      13484/mysqld        
tcp        0      0 127.0.0.1:11211         0.0.0.0:*               LISTEN      16744/memcached     
tcp        0      0 0.0.0.0:4369            0.0.0.0:*               LISTEN      14861/epmd          
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      8537/systemd-resolv 
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      4164/sshd           
tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN      28252/cupsd         
tcp6       0      0 :::5672                 :::*                    LISTEN      15015/beam.smp      
tcp6       0      0 :::4369                 :::*                    LISTEN      14861/epmd          
tcp6       0      0 :::22                   :::*                    LISTEN      4164/sshd           
tcp6       0      0 ::1:631                 :::*                    LISTEN      28252/cupsd         


